This is your new task

# Overview

# preferred directory structure

Backoffice/DealerManagement

# route notes

This is an authenticated interface and must live inside the "auth:backoffice" middleware already applied in the backoffice.php routes file

# Who can access

## dealer guard: no
## backoffice guard:

If the following keys are set:

- indexDealerships: for index() function
- createDealerships: for create() and store() function
- editDealerships: for edit() and update() function
- deleteDealerships: for destroy() function

### controller

Preferred controller name: DealersController

# vuejs abilities list

Inside app/Http/Middleware/HandleInertiaRequests.php we set the "abilities" key inside auth => user - use this abilities to conditionally show the following link:

## vuejs navigation resources/backoffice/js/Layouts/Layout.vue

There is already a Dealership menu item in the main navigation

If the user has the ability on the permissions key "indexDealerships" then show this link otherwise not.

## validation notes

Ensure that the actions in the datatable shows and allows actions only based on the permission keys outlined and that actions in the datatable show only if allowed

# what is needed

The following is NOT limited to what needs to be done, but serves as a minimum guideline:

- Controller
- Gate / security implementation as explained in context/project_information.txt
- vuejs files

# context

We will now move on to the dealership index page.

We will do the view / edit / create later on and for now focus on the dealership index page only.

Super important is:

## deferred loading - refer to the project notes about deferred loading and go through every single line of the legacy files in context/tasks/legacyFiles

The legacy files contains the create and edit and other components but we will focus on the index page only

Use the legacy files as guideline only but make sure the deferred loading is implemented, and that all deferred datasets started with the the specific prefix

## filters - super important. go through the legacy files - i want the same functionality. There are some items which is only enabled for filtering if a type is selected.

And for the location, the rules that i have explained when implementing the locations, about the parent and child - same applies here, to show only what is available at the time of filtering.

Also all the filters that are currently there is what i want and the same ordering abilities.

You can almost say i want a refactor but as a new implementation and a cleanup.

Make sure you visit all the rules especially about form requests, validation, deferred loading, gates, policies and all. So kinda refactor but as a new implementation, also info resources for the responses, there is massive cleanup.

Take special note of app/Support/StockHelper.php stockRelationMeta() this you will use a lot as it shows what relations are availble to the stock.

dont make mistakes and dont loose functionality and rememebr for minimal db quesries and to upfront load relevant relationships.

then on the index page there is a button to create stock, link it to a dummy link for the moment.

there is also icons to view, edit, activate, deactivate, delete and notes.

revisit the information about notes it is important that it keeps working

the view and edit can be dummy linked, but rememebr to link it up when we get there

delete and activate and deactivate you can fully implement that

and remember that is said i dont like the through() thing int he controllers and that there should not be private or protected functions in the controller.

# legacy files

see all the legacy files inside context/tasks/legacyFiles
